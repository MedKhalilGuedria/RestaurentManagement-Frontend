var MadNewsletter=function(d){function f(a,b){this.form=a;this.config=b;this.initValidator();a.data("config",b)}var e={url:"php/subscribe.php",onSuccess:function(a){},onError:function(a){}};f.prototype.initValidator=function(){var a=this;this.form.get(0)instanceof HTMLFormElement&&window.Validator&&this.form.data("validator",new Validator({form:a.form.get(0),cssPrefix:"apo-",incorrectClass:"invalid",correctClass:"valid",rules:[{element:a.form.get(0).elements.email,name:"Email",rules:{empty:null,
pattern:/^(([^<>()\[\]\.,;:\s@"]+(\.[^<>()\[\]\.,;:\s@"]+)*)|(".+"))@(([^<>()[\]\.,;:\s@"]+\.)+[^<>()[\]\.,;:\s@"]{2,})$/i}}],onIncorrect:function(b){Mad&&Mad.modules&&Mad.modules.alertMessage&&Mad.modules.alertMessage({target:a.form,type:"error",message:b})},onCorrect:a.send}))};f.prototype.send=function(){var a=d(this),b=a.data("config");d.ajax({url:b.url,type:"POST",dataType:"json",data:a.serialize(),success:function(c){c.status&&"fail"==c.status?(Mad&&Mad.modules&&Mad.modules.alertMessage&&
Mad.modules.alertMessage({target:a,type:"error",message:c.errors}),b.onError.call(a,c)):c.status&&"success"==c.status&&(Mad&&Mad.modules&&Mad.modules.alertMessage&&Mad.modules.alertMessage({target:a,type:"success",message:c.statusText}),a.find("input").val(""),b.onSuccess.call(a,c))},error:function(c,d,g){Mad&&Mad.modules&&Mad.modules.alertMessage&&Mad.modules.alertMessage({target:a,type:"error",message:g});b.onError.call(a,arguments)}})};return function(a,b){if(!a||
!a.length)return!1;b=b&&d.isPlainObject(b)?d.extend(!0,{},e,b):e;return a.each(function(a,e){var c=d(e);c.data("Newsletter")||c.data("Newsletter",new f(c,b))})}}(jQuery);
